////  AuthenticationView.swift//  FinalProject//import SwiftUIimport ParseSwiftstruct AuthenticationView: View {    @State private var isSignUp = false    @State private var username = ""    @State private var email = ""    @State private var password = ""    @State private var confirmPassword = ""    @State private var errorMessage = ""    @State private var isLoading = false        var body: some View {        ZStack {            // Black to White Gradient            LinearGradient(                colors: [Color.black, Color.white],                startPoint: .top,                endPoint: .bottom            )            .ignoresSafeArea()                        VStack(spacing: 40) {                Spacer()                                // Logo                VStack(spacing: 20) {                    Circle()                        .stroke(Color.white, lineWidth: 3)                        .frame(width: 100, height: 100)                        .overlay(                            Text("S")                                .font(.system(size: 50, weight: .bold))                                .foregroundColor(.white)                        )                                        Text("Slice")                        .font(.system(size: 48, weight: .bold))                        .foregroundColor(.white)                }                .padding(.top, 60)                                Spacer()                                // Form                VStack(spacing: 20) {                    if isSignUp {                        // Sign Up Form                        VStack(spacing: 16) {                            InputField(title: "Username", text: $username)                            InputField(title: "Email", text: $email)                            SecureInputField(title: "Password", text: $password)                            SecureInputField(title: "Confirm Password", text: $confirmPassword)                        }                                                if !errorMessage.isEmpty {                            Text(errorMessage)                                .font(.system(size: 14))                                .foregroundColor(.red)                        }                                                Button(action: handleSignUp) {                            if isLoading {                                ProgressView()                                    .progressViewStyle(CircularProgressViewStyle(tint: .white))                            } else {                                Text("Create Account")                                    .font(.system(size: 16, weight: .semibold))                                    .foregroundColor(.white)                            }                        }                        .frame(maxWidth: .infinity)                        .padding(.vertical, 16)                        .background(Color.black)                        .cornerRadius(12)                        .disabled(isLoading)                                                Button(action: { isSignUp = false }) {                            HStack(spacing: 4) {                                Text("Already have an account?")                                    .foregroundColor(.gray)                                Text("Sign In")                                    .fontWeight(.semibold)                                    .foregroundColor(.black)                            }                            .font(.system(size: 14))                        }                                            } else {                        // Sign In Form                        VStack(spacing: 16) {                            InputField(title: "Email", text: $email)                            SecureInputField(title: "Password", text: $password)                        }                                                if !errorMessage.isEmpty {                            Text(errorMessage)                                .font(.system(size: 14))                                .foregroundColor(.red)                        }                                                Button(action: handleSignIn) {                            if isLoading {                                ProgressView()                                    .progressViewStyle(CircularProgressViewStyle(tint: .white))                            } else {                                Text("Sign In")                                    .font(.system(size: 16, weight: .semibold))                                    .foregroundColor(.white)                            }                        }                        .frame(maxWidth: .infinity)                        .padding(.vertical, 16)                        .background(Color.black)                        .cornerRadius(12)                        .disabled(isLoading)                                                Button(action: { isSignUp = true }) {                            HStack(spacing: 4) {                                Text("Don't have an account?")                                    .foregroundColor(.gray)                                Text("Sign Up")                                    .fontWeight(.semibold)                                    .foregroundColor(.black)                            }                            .font(.system(size: 14))                        }                    }                }                .padding(.horizontal, 40)                .padding(.bottom, 40)            }        }    }        func handleSignUp() {        errorMessage = ""                // Validation        guard !username.isEmpty, !email.isEmpty, !password.isEmpty else {            errorMessage = "Please fill in all fields"            return        }                guard password == confirmPassword else {            errorMessage = "Passwords don't match"            return        }                guard password.count >= 6 else {            errorMessage = "Password must be at least 6 characters"            return        }                isLoading = true                print("==================================================")        print("üîµ STARTING SIGNUP")        print("   Username: \(username)")        print("   Email: \(email)")        print("==================================================")                Task {            do {                // Create user with Parse                print("üîµ Step 1: Calling ParseService.signUp...")                var user = try await ParseService.shared.signUp(                    username: username,                    email: email,                    password: password                )                                print("‚úÖ Step 1 Complete: User created in Parse")                print("   ObjectId: \(user.objectId ?? "unknown")")                print("   Username: \(user.username ?? "nil")")                                // ‚≠ê Update searchable fields automatically                print("\nüîµ Step 2: Setting user fields...")                user.displayName = username                user.updateSearchableFields()                user.isVerified = false                user.followersCount = 0                user.followingCount = 0                user.postsCount = 0                                print("   displayName: \(user.displayName ?? "nil")")                print("   usernameTag: \(user.usernameTag ?? "nil")")                print("   searchableName: \(user.searchableName ?? "nil")")                                // Save the updated user                print("\nüîµ Step 3: Saving updated user to Back4App...")                let savedUser = try await user.save()                                print("‚úÖ Step 3 Complete: User fields saved!")                print("   ObjectId: \(savedUser.objectId ?? "unknown")")                print("   username: \(savedUser.username ?? "nil")")                print("   usernameTag: \(savedUser.usernameTag ?? "nil")")                print("   searchableName: \(savedUser.searchableName ?? "nil")")                print("   displayName: \(savedUser.displayName ?? "nil")")                                print("\n==================================================")                print("üéâ SIGNUP SUCCESSFUL FOR: @\(username)")                print("==================================================")                                await MainActor.run {                    isLoading = false                    NotificationCenter.default.post(name: NSNotification.Name("UserLoggedIn"), object: nil)                }            } catch {                print("\n==================================================")                print("‚ùå SIGNUP FAILED")                print("   Error: \(error)")                print("   Description: \(error.localizedDescription)")                print("==================================================")                                await MainActor.run {                    isLoading = false                    errorMessage = error.localizedDescription                }            }        }    }        func handleSignIn() {        errorMessage = ""                guard !email.isEmpty, !password.isEmpty else {            errorMessage = "Please fill in all fields"            return        }                isLoading = true                print("==================================================")        print("üîµ SIGNING IN")        print("   Email: \(email)")        print("==================================================")                Task {            do {                let user = try await ParseService.shared.signIn(                    username: email,                    password: password                )                                print("‚úÖ SIGN IN SUCCESSFUL")                print("   User: @\(user.username ?? "unknown")")                print("   ObjectId: \(user.objectId ?? "unknown")")                print("==================================================")                                await MainActor.run {                    isLoading = false                    NotificationCenter.default.post(name: NSNotification.Name("UserLoggedIn"), object: nil)                }            } catch {                print("‚ùå SIGN IN FAILED")                print("   Error: \(error.localizedDescription)")                print("==================================================")                                await MainActor.run {                    isLoading = false                    errorMessage = error.localizedDescription                }            }        }    }}struct InputField: View {    let title: String    @Binding var text: String        var body: some View {        VStack(alignment: .leading, spacing: 8) {            Text(title)                .font(.system(size: 14, weight: .medium))                .foregroundColor(.black)                        TextField("", text: $text)                .font(.system(size: 16))                .padding(14)                .background(Color.black.opacity(0.05))                .cornerRadius(12)                .autocapitalization(.none)        }    }}struct SecureInputField: View {    let title: String    @Binding var text: String        var body: some View {        VStack(alignment: .leading, spacing: 8) {            Text(title)                .font(.system(size: 14, weight: .medium))                .foregroundColor(.black)                        SecureField("", text: $text)                .font(.system(size: 16))                .padding(14)                .background(Color.black.opacity(0.05))                .cornerRadius(12)        }    }}#Preview {    AuthenticationView()}